# üìä –î–µ—Ç–∞–ª—å–Ω–µ –ü–æ—è—Å–Ω–µ–Ω–Ω—è –ê–Ω–∞–ª—ñ—Ç–∏—á–Ω–æ—ó –°–∏—Å—Ç–µ–º–∏ Health Metrics

## üéØ **–©–û –í–ñ–ï –†–ï–ê–õ–Ü–ó–û–í–ê–ù–û**

### **3 –û–°–ù–û–í–ù–ò–• ENDPOINTS –î–õ–Ø –ê–ù–ê–õ–Ü–¢–ò–ö–ò:**

1. **üìà `POST /metrics/trends`** - —ñ—Å—Ç–æ—Ä–∏—á–Ω—ñ –¥–∞–Ω—ñ —Ç–∞ —Ç—Ä–µ–Ω–¥–∏
2. **üîÆ `POST /metrics/forecast`** - –ø—Ä–æ–≥–Ω–æ–∑–∏ –Ω–∞ –æ—Å–Ω–æ–≤—ñ AI  
3. **üß† `GET /insights_recent`** - –æ—Å—Ç–∞–Ω–Ω—ñ AI —ñ–Ω—Å–∞–π—Ç–∏

---

## üìà #1: ENDPOINT TRENDS - –Ü—Å—Ç–æ—Ä–∏—á–Ω—ñ –¥–∞–Ω—ñ

### **–©–æ —Ä–æ–±–∏—Ç—å:**
```javascript
// –ê–Ω–∞–ª—ñ–∑—É—î —ñ—Å—Ç–æ—Ä–∏—á–Ω—ñ –¥–∞–Ω—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –∑–∞ –æ–±—Ä–∞–Ω–∏–π –ø–µ—Ä—ñ–æ–¥
POST /metrics/trends
{
  "user_id": "uuid",
  "type_metric": "heart_rate", 
  "period": "day|week|month",
  "start_date": "2025-01-01",
  "end_date": "2025-01-31"
}
```

### **–õ–æ–≥—ñ–∫–∞ –æ–±—Ä–æ–±–∫–∏:**

#### **–ö—Ä–æ–∫ 1: –§—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è –¥–∞—Ç**
```javascript
// –¢–æ—á–Ω–∞ —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è –∑–∞ –¥—ñ–∞–ø–∞–∑–æ–Ω–æ–º –¥–∞—Ç
const filteredData = health_data.filter(h => 
  h.date >= start_date && h.date <= end_date
);
```

#### **–ö—Ä–æ–∫ 2: –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è —Ç–∏–ø—É –ø–µ—Ä—ñ–æ–¥—É**
```javascript
// –†–æ–∑—É–º–Ω–∞ –ª–æ–≥—ñ–∫–∞ –≥—Ä—É–ø—É–≤–∞–Ω–Ω—è
function determinePeriodType(startDate, endDate) {
  const diffDays = (endDate - startDate) / (1000 * 3600 * 24);
  
  if (diffDays <= 31) return 'day';     // –î–æ 1 –º—ñ—Å—è—Ü—è - –ø–æ –¥–Ω—è—Ö
  if (diffDays <= 120) return 'week';   // –î–æ 4 –º—ñ—Å—è—Ü—ñ–≤ - –ø–æ —Ç–∏–∂–Ω—è—Ö  
  return 'month';                       // –ë—ñ–ª—å—à–µ - –ø–æ –º—ñ—Å—è—Ü—è—Ö
}
```

#### **–ö—Ä–æ–∫ 3: –ö–∞–Ω–æ–Ω—ñ–∑–∞—Ü—ñ—è –¥–∞–Ω–∏—Ö**
```javascript
// –ü–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω–Ω—è —Å–∏—Ä–∏—Ö –¥–∞–Ω–∏—Ö –≤ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–æ–≤–∞–Ω–∏–π —Ñ–æ—Ä–º–∞—Ç
const canonicalData = {
  daily: [
    { date: "2025-01-01", daily_value: 72, daily_min: 68, daily_max: 76, count: 3 },
    { date: "2025-01-02", daily_value: 70, daily_min: 67, daily_max: 73, count: 2 }
  ],
  weekly: [...],
  monthly: [...]
};
```

#### **–ö—Ä–æ–∫ 4: –ó–∞–ø–æ–≤–Ω–µ–Ω–Ω—è –ø—Ä–æ–ø—É—Å–∫—ñ–≤**
```javascript
// –ó–∞–ø–æ–≤–Ω—é—î–º–æ –≤—ñ–¥—Å—É—Ç–Ω—ñ –¥–Ω—ñ –Ω—É–ª—å–æ–≤–∏–º–∏ –∑–Ω–∞—á–µ–Ω–Ω—è–º–∏
const filledData = fillMissingDays(groupedData, period, startDate, endDate);

// –†–µ–∑—É–ª—å—Ç–∞—Ç: –ø–æ—Å–ª—ñ–¥–æ–≤–Ω–∏–π —Ä—è–¥ –¥–∞–Ω–∏—Ö –±–µ–∑ –ø—Ä–æ–ø—É—Å–∫—ñ–≤
```

#### **–ö—Ä–æ–∫ 5: –†–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ —Ç—Ä–µ–Ω–¥—ñ–≤**
```javascript
// –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–π —Ä–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ –∑–º—ñ–Ω –º—ñ–∂ –ø–µ—Ä—ñ–æ–¥–∞–º–∏
const trendsData = addDifferencesByPeriod(filledData);

// –†–µ–∑—É–ª—å—Ç–∞—Ç –º—ñ—Å—Ç–∏—Ç—å:
// - difference_percent: +5.2% (–∑–º—ñ–Ω–∞ –≤—ñ–¥–Ω–æ—Å–Ω–æ –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ–≥–æ –¥–Ω—è)
// - trend: 'up'|'down'|'neutral'
```

---

## üîÆ #2: ENDPOINT FORECAST - –ü—Ä–æ–≥–Ω–æ–∑–∏

### **–©–æ —Ä–æ–±–∏—Ç—å:**
```javascript
// –ü—Ä–æ–≥–Ω–æ–∑—É—î –º–∞–π–±—É—Ç–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è –Ω–∞ –æ—Å–Ω–æ–≤—ñ —ñ—Å—Ç–æ—Ä–∏—á–Ω–∏—Ö –¥–∞–Ω–∏—Ö
POST /metrics/forecast
{
  "type_metric": "heart_rate"
  // –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—é –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è user_id
}
```

### **AI –õ–æ–≥—ñ–∫–∞ –ø—Ä–æ–≥–Ω–æ–∑—É–≤–∞–Ω–Ω—è:**

#### **–ö—Ä–æ–∫ 1: –ü—ñ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–∏—Ö –¥–ª—è AI**
```javascript
// –°—Ç–≤–æ—Ä—é—î —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–≤–∞–Ω–∏–π –∫–æ–Ω—Ç–µ–∫—Å—Ç –¥–ª—è AI
const aiPromptData = {
  metric: "heart_rate",
  metric_display_name: "resting heart rate", 
  trend: "up",
  percent_change: 6.2,
  lookback_days: 14,
  confidence: "moderate",
  current_value: 72,
  forecast_horizon: 7
};
```

#### **–ö—Ä–æ–∫ 2: AI –ê–Ω–∞–ª—ñ–∑ —á–µ—Ä–µ–∑ OpenAI**
```javascript
// –í—ñ–¥–ø—Ä–∞–≤–ª—è—î –∑–∞–ø–∏—Ç –¥–æ GPT API
const aiResponse = await fetch('https://api.openai.com/v1/chat/completions', {
  method: 'POST',
  headers: {
    'Authorization': `Bearer ${apiKey}`,
    'Content-Type': 'application/json'
  },
  body: JSON.stringify({
    model: "gpt-4",
    messages: [{
      role: "user",
      content: `You are a health data analyst. Explain this trend: ${aiPromptData}`
    }]
  })
});
```

#### **–ö—Ä–æ–∫ 3: –ë–µ–∑–ø–µ—á–Ω–∞ –æ–±—Ä–æ–±–∫–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ**
```javascript
// –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ç–∞ —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è AI –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ
function validateAIResponse(response) {
  // –í–∏–¥–∞–ª—è—î–º–æ –º–µ–¥–∏—á–Ω—ñ –¥—ñ–∞–≥–Ω–æ–∑–∏
  // –î–æ–¥–∞—î–º–æ –¥–∏—Å–∫–ª–µ–π–º–µ—Ä–∏
  // –û–±–º–µ–∂—É—î–º–æ –¥–æ–≤–∂–∏–Ω—É –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ
  return safeResponse;
}
```

---

## üß† #3: ENDPOINT INSIGHTS - –û—Å—Ç–∞–Ω–Ω—ñ —ñ–Ω—Å–∞–π—Ç–∏

### **–©–æ —Ä–æ–±–∏—Ç—å:**
```javascript
// –û—Ç—Ä–∏–º—É—î –Ω–∞–π–Ω–æ–≤—ñ—à–∏–π AI —ñ–Ω—Å–∞–π—Ç –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ—ó –º–µ—Ç—Ä–∏–∫–∏
GET /insights_recent?user_id=xxx&type_metric=heart_rate
```

### **–õ–æ–≥—ñ–∫–∞ –ø–æ—à—É–∫—É:**
```javascript
// –®—É–∫–∞—î –≤ –±–∞–∑—ñ –¥–∞–Ω–∏—Ö ai_insights
const filtered = insights.filter(insight =>
  insight.data_sources?.metrics?.some(m => m.metric_type === typeMetric)
);

// –ó–Ω–∞—Ö–æ–¥–∏—Ç—å –Ω–∞–π–Ω–æ–≤—ñ—à–∏–π —ñ–Ω—Å–∞–π—Ç
const latestInsight = filtered.reduce((latest, current) => 
  current.created_at > latest.created_at ? current : latest
);
```

---

## üéØ **–ö–û–õ–ò –¢–ê –•–¢–û –í–ò–ö–õ–ò–ö–ê–Ñ –¶–Ü ENDPOINTS**

### **üì± –í–ò–ö–õ–ò–ö–ò –ó –§–†–û–ù–¢–ï–ù–î–£**

#### **1. –ü—Ä–∏ –≤—ñ–¥–∫—Ä–∏—Ç—Ç—ñ —Å—Ç–æ—Ä—ñ–Ω–∫–∏ –º–µ—Ç—Ä–∏–∫–∏**
```javascript
// –ö–û–õ–ò: –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç—å –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω–∫—É "Heart Rate"
// –ß–û–ú–£: –ü–æ–∫–∞–∑–∞—Ç–∏ –ø–æ–≤–Ω—É –∫–∞—Ä—Ç–∏–Ω—É - —ñ—Å—Ç–æ—Ä—ñ—é + –ø—Ä–æ–≥–Ω–æ–∑

useEffect(() => {
  // –ó–∞–≤–∞–Ω—Ç–∞–∂—É—î–º–æ —Ç—Ä–µ–Ω–¥–∏
  const trends = await fetch('/metrics/trends', {
    method: 'POST',
    body: JSON.stringify({
      type_metric: 'heart_rate',
      period: 'month',
      start_date: '2025-01-01',
      end_date: '2025-01-31'
    })
  });
  
  // –ó–∞–≤–∞–Ω—Ç–∞–∂—É—î–º–æ –ø—Ä–æ–≥–Ω–æ–∑
  const forecast = await fetch('/metrics/forecast', {
    method: 'POST', 
    body: JSON.stringify({
      type_metric: 'heart_rate'
    })
  });
  
  // –ó–∞–≤–∞–Ω—Ç–∞–∂—É—î–º–æ –æ—Å—Ç–∞–Ω–Ω—ñ–π —ñ–Ω—Å–∞–π—Ç
  const insight = await fetch('/insights_recent?type_metric=heart_rate');
}, []);
```

#### **2. –ü—Ä–∏ –∑–º—ñ–Ω—ñ –ø–µ—Ä—ñ–æ–¥—É –Ω–∞ –≥—Ä–∞—Ñ—ñ–∫—É**
```javascript
// –ö–û–õ–ò: –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –≤–∏–±–∏—Ä–∞—î "3 –º—ñ—Å—è—Ü—ñ" –∑–∞–º—ñ—Å—Ç—å "1 –º—ñ—Å—è—Ü—å"
// –ß–û–ú–£: –û–Ω–æ–≤–∏—Ç–∏ –¥–∞–Ω—ñ –¥–ª—è –Ω–æ–≤–æ–≥–æ –¥—ñ–∞–ø–∞–∑–æ–Ω—É

const handlePeriodChange = async (newPeriod) => {
  const response = await fetch('/metrics/trends', {
    method: 'POST',
    body: JSON.stringify({
      type_metric: currentMetric,
      period: newPeriod,
      start_date: calculateStartDate(newPeriod),
      end_date: getToday()
    })
  });
  
  updateChart(await response.json());
};
```

#### **3. –ü—Ä–∏ –¥–æ–¥–∞–≤–∞–Ω–Ω—ñ –Ω–æ–≤–∏—Ö –¥–∞–Ω–∏—Ö**
```javascript
// –ö–û–õ–ò: –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –¥–æ–¥–∞—î –Ω–æ–≤–µ –∑–Ω–∞—á–µ–Ω–Ω—è –ø—É–ª—å—Å—É
// –ß–û–ú–£: –û–Ω–æ–≤–∏—Ç–∏ –ø—Ä–æ–≥–Ω–æ–∑–∏ —Ç–∞ —ñ–Ω—Å–∞–π—Ç–∏

const handleNewData = async (newValue) => {
  // –ó–±–µ—Ä—ñ–≥–∞—î–º–æ –¥–∞–Ω—ñ
  await saveMetric('heart_rate', newValue);
  
  // –û–Ω–æ–≤–ª—é—î–º–æ –ø—Ä–æ–≥–Ω–æ–∑–∏
  const newForecast = await fetch('/metrics/forecast', {
    method: 'POST',
    body: JSON.stringify({ type_metric: 'heart_rate' })
  });
  
  // –û–Ω–æ–≤–ª—é—î–º–æ —ñ–Ω—Å–∞–π—Ç–∏
  const newInsight = await fetch('/insights_recent?type_metric=heart_rate');
};
```

### **‚öôÔ∏è –í–ò–ö–õ–ò–ö–ò –ó –ë–ï–ö–ï–ù–î–£**

#### **1. –ù—ñ—á–Ω–∏–π –ø—Ä–æ—Ü–µ—Å –æ–Ω–æ–≤–ª–µ–Ω–Ω—è —ñ–Ω—Å–∞–π—Ç—ñ–≤**
```javascript
// –ö–û–õ–ò: –©–æ–¥–Ω—è –æ 2:00 –Ω–æ—á—ñ
// –ß–û–ú–£: –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è –Ω–æ–≤–∏—Ö AI —ñ–Ω—Å–∞–π—Ç—ñ–≤ –¥–ª—è –≤—Å—ñ—Ö –∞–∫—Ç–∏–≤–Ω–∏—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤

cron.schedule('0 2 * * *', async () => {
  const activeUsers = await getActiveUsers();
  
  for (const user of activeUsers) {
    const userMetrics = await getRecentMetrics(user.id);
    
    // –ì–µ–Ω–µ—Ä—É—î–º–æ —ñ–Ω—Å–∞–π—Ç–∏ –¥–ª—è –∫–æ–∂–Ω–æ—ó –º–µ—Ç—Ä–∏–∫–∏
    for (const metric of userMetrics) {
      const insight = await generateAIInsight(user.id, metric);
      await saveAIInsight(insight);
    }
  }
});
```

#### **2. –ü—ñ—Å–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—ó –∑ wearable**
```javascript
// –ö–û–õ–ò: –û—Ç—Ä–∏–º–∞–Ω–æ –Ω–æ–≤—ñ –¥–∞–Ω—ñ –∑ Apple Watch
// –ß–û–ú–£: –û–Ω–æ–≤–∏—Ç–∏ –ø—Ä–æ–≥–Ω–æ–∑–∏ –Ω–∞ –æ—Å–Ω–æ–≤—ñ —Å–≤—ñ–∂–∏—Ö –¥–∞–Ω–∏—Ö

app.post('/webhook/wearable-data', async (req, res) => {
  const newData = processWearableData(req.body);
  
  // –û–Ω–æ–≤–ª—é—î–º–æ –ø—Ä–æ–≥–Ω–æ–∑–∏ –¥–ª—è –≤—Å—ñ—Ö –º–µ—Ç—Ä–∏–∫
  for (const metric of Object.keys(newData)) {
    await fetch('/metrics/forecast', {
      method: 'POST',
      body: JSON.stringify({
        user_id: newData.user_id,
        type_metric: metric
      })
    });
  }
});
```

---

## üé™ **–ü–†–ê–ö–¢–ò–ß–ù–Ü –ü–†–ò–ö–õ–ê–î–ò –í–ò–ö–û–†–ò–°–¢–ê–ù–ù–Ø**

### **–°—Ü–µ–Ω–∞—Ä—ñ–π 1: –ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥ —Ç–∏—Å–∫—É**
```
üë§ –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á: "–•–æ—á—É –ø–æ–±–∞—á–∏—Ç–∏ —Ç–µ–Ω–¥–µ–Ω—Ü—ñ—ó –º–æ–≥–æ —Ç–∏—Å–∫—É –∑–∞ –æ—Å—Ç–∞–Ω–Ω—ñ 3 –º—ñ—Å—è—Ü—ñ"

üì± –§—Ä–æ–Ω—Ç–µ–Ω–¥ –≤–∏–∫–ª–∏–∫–∞—î:
1. POST /metrics/trends - —Ç—Ä–µ–Ω–¥–∏ –∑–∞ 3 –º—ñ—Å—è—Ü—ñ
2. POST /metrics/forecast - –ø—Ä–æ–≥–Ω–æ–∑ –Ω–∞ –Ω–∞—Å—Ç—É–ø–Ω–∏–π —Ç–∏–∂–¥–µ–Ω—å
3. GET /insights_recent - –æ—Å—Ç–∞–Ω–Ω—ñ–π —ñ–Ω—Å–∞–π—Ç –ø—Ä–æ —Ç–∏—Å–∫

üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç:
- üìä –ì—Ä–∞—Ñ—ñ–∫ –∑ —Ç–µ–Ω–¥–µ–Ω—Ü—ñ—î—é –∑–Ω–∏–∂–µ–Ω–Ω—è
- üîÆ –ü—Ä–æ–≥–Ω–æ–∑: "–¢–∏—Å–∫ —Å—Ç–∞–±—ñ–ª—ñ–∑—É—î—Ç—å—Å—è –Ω–∞ —Ä—ñ–≤–Ω—ñ 125/80"
- üí° –Ü–Ω—Å–∞–π—Ç: "–í–∞—à —Å–∏—Å—Ç–æ–ª—ñ—á–Ω–∏–π —Ç–∏—Å–∫ –ø–æ–∫—Ä–∞—â–∏–≤—Å—è –Ω–∞ 8% –∑–∞ 3 –º—ñ—Å—è—Ü—ñ"
```

### **–°—Ü–µ–Ω–∞—Ä—ñ–π 2: –ê–Ω–∞–ª—ñ–∑ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ**
```
üë§ –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á: "–ß–æ–º—É —è –≤—ñ–¥—á—É–≤–∞—é –≤—Ç–æ–º—É? –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –∞–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å"

üì± –§—Ä–æ–Ω—Ç–µ–Ω–¥ –≤–∏–∫–ª–∏–∫–∞—î:
1. POST /metrics/trends - –∞–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å –∑–∞ –æ—Å—Ç–∞–Ω–Ω—ñ 2 —Ç–∏–∂–Ω—ñ
2. POST /metrics/forecast - –ø—Ä–æ–≥–Ω–æ–∑ –µ–Ω–µ—Ä–≥—ñ–π–Ω–æ—Å—Ç—ñ
3. GET /insights_recent - —ñ–Ω—Å–∞–π—Ç –ø—Ä–æ –ø–∞—Ç–µ—Ä–Ω–∏ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ

üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç:
- üìä –ì—Ä–∞—Ñ—ñ–∫: —Ä—ñ–∑–∫–µ –∑–Ω–∏–∂–µ–Ω–Ω—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ –≤—á–æ—Ä–∞
- üîÆ –ü—Ä–æ–≥–Ω–æ–∑: "–í—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ —á–µ—Ä–µ–∑ 2-3 –¥–Ω—ñ"
- üí° –Ü–Ω—Å–∞–π—Ç: "–í–∞—à–∞ –∞–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å –∑–Ω–∏–∑–∏–ª–∞—Å—å –Ω–∞ 40% –ø—ñ—Å–ª—è —ñ–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ–≥–æ —Ç—Ä–µ–Ω—É–≤–∞–Ω–Ω—è"
```

### **–°—Ü–µ–Ω–∞—Ä—ñ–π 3: –ü–ª–∞–Ω—É–≤–∞–Ω–Ω—è —Ç—Ä–µ–Ω—É–≤–∞–Ω—å**
```
üë§ –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á: "–ü–ª–∞–Ω—É—é —Ç—Ä–µ–Ω—É–≤–∞–Ω–Ω—è - —á–∏ –≥–æ—Ç–æ–≤–∏–π –º—ñ–π –æ—Ä–≥–∞–Ω—ñ–∑–º?"

üì± –§—Ä–æ–Ω—Ç–µ–Ω–¥ –≤–∏–∫–ª–∏–∫–∞—î:
1. POST /metrics/trends - –ø—É–ª—å—Å —Å–ø–æ–∫–æ—é –∑–∞ –º—ñ—Å—è—Ü—å
2. POST /metrics/forecast - –ø—Ä–æ–≥–Ω–æ–∑ –≤—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è
3. GET /insights_recent - —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó –ø–æ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—é

üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç:
- üìä –ì—Ä–∞—Ñ—ñ–∫: —Å—Ç–∞–±—ñ–ª—å–Ω–∏–π –ø—É–ª—å—Å —Å–ø–æ–∫–æ—é
- üîÆ –ü—Ä–æ–≥–Ω–æ–∑: "–Ü–¥–µ–∞–ª—å–Ω–∏–π —á–∞—Å –¥–ª—è —Ç—Ä–µ–Ω—É–≤–∞–Ω–Ω—è - –∑–∞–≤—Ç—Ä–∞ –≤—Ä–∞–Ω—Ü—ñ"
- üí° –Ü–Ω—Å–∞–π—Ç: "–í–∞—à –æ—Ä–≥–∞–Ω—ñ–∑–º –¥–æ–±—Ä–µ –≤—ñ–¥–Ω–æ–≤–ª—é—î—Ç—å—Å—è –ø—ñ—Å–ª—è –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω—å"
```

---

## üîß **–¢–ï–•–ù–Ü–ß–ù–Ü –û–°–û–ë–õ–ò–í–û–°–¢–Ü**

### **–û–±—Ä–æ–±–∫–∞ —á–∞—Å–æ–≤–∏—Ö –ø–æ—è—Å—ñ–≤:**
```javascript
// –ö—Ä–∏—Ç–∏—á–Ω–æ –≤–∞–∂–ª–∏–≤–æ –¥–ª—è –∫–æ—Ä–µ–∫—Ç–Ω–æ–≥–æ –≥—Ä—É–ø—É–≤–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö
function convertToTimezone(dateString, userTimezone) {
  // –ö–æ–Ω–≤–µ—Ä—Ç—É—î –≤—Å—ñ –¥–∞—Ç–∏ –≤ —á–∞—Å–æ–≤–∏–π –ø–æ—è—Å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
  // –ó–∞–±–µ–∑–ø–µ—á—É—î –∫–æ—Ä–µ–∫—Ç–Ω–µ –≥—Ä—É–ø—É–≤–∞–Ω–Ω—è –ø–æ –¥–Ω—è—Ö/—Ç–∏–∂–Ω—è—Ö
}
```

### **–†–æ–±–æ—á–∞ –æ–±—Ä–æ–±–∫–∞ –¥–∞–Ω–∏—Ö:**
```javascript
// –í–∏–¥–∞–ª–µ–Ω–Ω—è –≤–∏–∫–∏–¥—ñ–≤ –¥–ª—è –∫—Ä–æ–≤'—è–Ω–æ–≥–æ —Ç–∏—Å–∫—É
function winsorizeBloodPressure(values) {
  // –í–∏–¥–∞–ª—è—î –∫—Ä–∞–π–Ω—ñ 5% –∑–Ω–∞—á–µ–Ω—å
  // –ó–∞–ø–æ–±—ñ–≥–∞—î –ø–æ–º–∏–ª–∫–æ–≤–∏–º –ø—Ä–æ–≥–Ω–æ–∑–∞–º
}
```

### **–†–æ–∑—É–º–Ω–∞ –∞–≥—Ä–µ–≥–∞—Ü—ñ—è:**
```javascript
// –î–ª—è –∫–æ–∂–Ω–æ–≥–æ —Ç–∏–ø—É –º–µ—Ç—Ä–∏–∫–∏ - —Å–≤–æ—è –ª–æ–≥—ñ–∫–∞ –∞–≥—Ä–µ–≥–∞—Ü—ñ—ó
const aggregationRules = {
  heart_rate: 'median',          // –ú–µ–¥—ñ–∞–Ω–∞ –¥–ª—è –ø—É–ª—å—Å—É
  blood_pressure: 'daily_median', // –ú–µ–¥—ñ–∞–Ω–∞ –ø–æ –¥–Ω—è—Ö –¥–ª—è —Ç–∏—Å–∫—É
  sleep_hours: 'sum',            // –°—É–º–∞ –¥–ª—è —Å–Ω—É
  activity: 'average'            // –°–µ—Ä–µ–¥–Ω—î –¥–ª—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ
};
```

---

## üõ°Ô∏è **–°–ò–°–¢–ï–ú–ê –ë–ï–ó–ü–ï–ö–ò**

### **–û–±–º–µ–∂–µ–Ω–Ω—è AI –≤—ñ–¥–ø–æ–≤—ñ–¥–µ–π:**
```javascript
// –ó–∞–ø–æ–±—ñ–≥–∞—î–º–æ –º–µ–¥–∏—á–Ω–∏–º –¥—ñ–∞–≥–Ω–æ–∑–∞–º
const safetyFilters = {
  noDiagnosis: true,     // –ù–µ –¥—ñ–∞–≥–Ω–æ—Å—Ç—É—î–º–æ
  noPrescriptions: true, // –ù–µ –ø—Ä–∏–∑–Ω–∞—á–∞—î–º–æ –ª—ñ–∫–∏
  educationalOnly: true  // –¢—ñ–ª—å–∫–∏ –æ—Å–≤—ñ—Ç–Ω—ñ —ñ–Ω—Å–∞–π—Ç–∏
};
```

### **–í–∞–ª—ñ–¥–∞—Ü—ñ—è –¥–∞–Ω–∏—Ö:**
```javascript
// –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ñ—ñ–∑—ñ–æ–ª–æ–≥—ñ—á–Ω–∏—Ö –º–µ–∂
function validateMetricValue(metric, value) {
  const bounds = {
    heart_rate: [30, 220],
    blood_pressure_systolic: [70, 250],
    blood_oxygen: [80, 100]
  };
  
  return value >= bounds[metric][0] && value <= bounds[metric][1];
}
```

---

## üìä **–ü–ï–†–ï–í–ê–ì–ò –†–ï–ê–õ–Ü–ó–û–í–ê–ù–û–á –°–ò–°–¢–ï–ú–ò**

### **‚úÖ –î–ª—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞:**
- **üìà –ü–æ–≤–Ω–∞ –≤—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—è** - —ñ—Å—Ç–æ—Ä—ñ—è + –ø—Ä–æ–≥–Ω–æ–∑ + —ñ–Ω—Å–∞–π—Ç–∏
- **üîÆ –ü—Ä–æ–∞–∫—Ç–∏–≤–Ω—ñ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó** - —â–æ —á–µ–∫–∞—Ç–∏ –≤ –º–∞–π–±—É—Ç–Ω—å–æ–º—É
- **üéØ –ü–µ—Ä—Å–æ–Ω–∞–ª—ñ–∑–æ–≤–∞–Ω—ñ —ñ–Ω—Å–∞–π—Ç–∏** - –Ω–∞ –æ—Å–Ω–æ–≤—ñ –≤–∞—à–∏—Ö –¥–∞–Ω–∏—Ö
- **‚è±Ô∏è –ï–∫–æ–Ω–æ–º—ñ—è —á–∞—Å—É** - –≤—Å—è —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –≤ –æ–¥–Ω–æ–º—É –º—ñ—Å—Ü—ñ

### **‚úÖ –î–ª—è —Ä–æ–∑—Ä–æ–±–Ω–∏–∫—ñ–≤:**
- **üß© –ú–æ–¥—É–ª—å–Ω–∞ –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞** - –∫–æ–∂–µ–Ω endpoint –≤–∏–∫–æ–Ω—É—î –æ–¥–Ω—É –∑–∞–¥–∞—á—É
- **‚ö° –û–ø—Ç–∏–º—ñ–∑–æ–≤–∞–Ω–∞ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å** - —Ä–æ–∑–¥—ñ–ª–µ–Ω–Ω—è —Ç—Ä–µ–Ω–¥—ñ–≤ —Ç–∞ –ø—Ä–æ–≥–Ω–æ–∑—ñ–≤
- **üîí –ë–µ–∑–ø–µ–∫–∞** - –æ–±–º–µ–∂–µ–Ω–Ω—è AI –≤—ñ–¥–ø–æ–≤—ñ–¥–µ–π
- **üìö –ú–∞—Å—à—Ç–∞–±–æ–≤–∞–Ω—ñ—Å—Ç—å** - –ª–µ–≥–∫–µ –¥–æ–¥–∞–≤–∞–Ω–Ω—è –Ω–æ–≤–∏—Ö –º–µ—Ç—Ä–∏–∫

### **‚úÖ –î–ª—è –±—ñ–∑–Ω–µ—Å—É:**
- **üíé –£–Ω—ñ–∫–∞–ª—å–Ω–∞ —Ü—ñ–Ω–Ω—ñ—Å—Ç—å** - AI –ø—Ä–æ–≥–Ω–æ–∑–∏ –≤—ñ–¥—Ä—ñ–∑–Ω—è—é—Ç—å –≤—ñ–¥ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç—ñ–≤
- **üìä –ì–ª–∏–±–æ–∫—ñ —ñ–Ω—Å–∞–π—Ç–∏** - —Ä–æ–∑—É–º—ñ–Ω–Ω—è –ø–∞—Ç–µ—Ä–Ω—ñ–≤ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤
- **üîÆ –ü—Ä–æ–≥–Ω–æ—Å—Ç–∏—á–Ω–∞ –∞–Ω–∞–ª—ñ—Ç–∏–∫–∞** - –∑–∞–ø–æ–±—ñ–≥–∞–Ω–Ω—è –ø—Ä–æ–±–ª–µ–º–∞–º –¥–æ —ó—Ö –≤–∏–Ω–∏–∫–Ω–µ–Ω–Ω—è

---

## üöÄ **–í–ò–°–ù–û–í–û–ö**

**–°–∏—Å—Ç–µ–º–∞ –ø–æ–≤–Ω–æ—Ü—ñ–Ω–Ω–æ –≥–æ—Ç–æ–≤–∞ –¥–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è** —Ç–∞ –Ω–∞–¥–∞—î:

1. **üìä –ì–ª–∏–±–æ–∫–∏–π –∞–Ω–∞–ª—ñ–∑** —ñ—Å—Ç–æ—Ä–∏—á–Ω–∏—Ö –¥–∞–Ω–∏—Ö
2. **üîÆ –¢–æ—á–Ω—ñ –ø—Ä–æ–≥–Ω–æ–∑–∏** –Ω–∞ –æ—Å–Ω–æ–≤—ñ –º–∞—à–∏–Ω–Ω–æ–≥–æ –Ω–∞–≤—á–∞–Ω–Ω—è  
3. **üí° –¶—ñ–Ω–Ω—ñ —ñ–Ω—Å–∞–π—Ç–∏** –≤—ñ–¥ AI
4. **üéØ –ü–µ—Ä—Å–æ–Ω–∞–ª—ñ–∑–æ–≤–∞–Ω—ñ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó** –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞

**–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ –æ—Ç—Ä–∏–º—É—é—Ç—å –Ω–µ –ø—Ä–æ—Å—Ç–æ —Ü–∏—Ñ—Ä–∏, –∞ –ø–æ–≤–Ω–æ—Ü—ñ–Ω–Ω—É —Å–∏—Å—Ç–µ–º—É –¥–ª—è –ø—Ä–æ–∞–∫—Ç–∏–≤–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –∑–¥–æ—Ä–æ–≤'—è–º!** üéØ